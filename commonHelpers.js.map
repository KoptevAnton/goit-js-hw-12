{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/js/refs.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com';\nconst ENDPOINT = 'api/';\nconst API_KEY = '44646887-2aa33964a79eef97580c1a22f';\naxios.defaults.baseURL = BASE_URL;\n\nexport default async ({ q = '', page = 1, pageSize = 15 } = {}) => {\n  try {\n    const response = await axios.get(ENDPOINT, {\n      params: {\n        key: API_KEY,\n        q,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        per_page: pageSize,\n        page: page,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    throw new Error('Sorry, something went wrong with the API request.');\n  }\n};\n","const createMarkup = images => {\n  return images\n    .map(\n      ({\n        tags,\n        webformatURL,\n        largeImageURL,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n          <li class=\"card-container\">\n            <a href=${largeImageURL} class=\"card-container__link js-card-link\">\n              <img loading=\"lazy\" class=\"card-container__photo\" src=\"${webformatURL}\" alt=\"${tags}\" >\n            </a>\n            <div class=\"card-container__thumb\">\n              <div class=\"card-container__meta\">\n                <span class=\"card-container__title\">Likes</span>\n                <span class=\"card-container__info\">${likes}</span>\n              </div>\n              <div class=\"card-container__meta\">\n                <span class=\"card-container__title\">Views</span>\n                <span class=\"card-container__info\">${views}</span>\n              </div>\n              <div class=\"card-container__meta\">\n                <span class=\"card-container__title\">Comments</span>\n                <span class=\"card-container__info\">${comments}</span>\n              </div>\n              <div class=\"card-container__meta\">\n                <span class=\"card-container__title\">Downloads</span>\n                <span class=\"card-container__info\">${downloads}</span>\n              </div>\n            </div>\n          </li>\n        `;\n      }\n    )\n    .join('');\n};\nexport default createMarkup;\n","const galleryEl = document.querySelector('.gallery');\nconst searchFormEl = document.querySelector('.search-form');\nconst loaderEl = document.querySelector('.loader');\nconst loadMoreEl = document.querySelector('.btn-load');\n\nexport { galleryEl, searchFormEl, loaderEl, loadMoreEl };\n","import './css/styles.scss';\nimport iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport fetchPhotos from './js/pixabay-api';\nimport createMarkup from './js/render-functions';\nimport * as refs from './js/refs';\n\nconst { galleryEl, searchFormEl, loaderEl, loadMoreEl } = refs;\nconst params = {\n  q: '',\n  page: 1,\n  pageSize: 9,\n  maxPage: 0,\n};\n\nloaderEl.classList.add('is-hidden');\nloadMoreEl.classList.add('is-hidden');\nlet lightbox = null;\n\nsearchFormEl.addEventListener('submit', onSearch);\n\nasync function onSearch(event) {\n  event.preventDefault();\n  galleryEl.innerHTML = '';\n  loadMoreEl.classList.add('is-hidden');\n  params.q = event.target.elements.searchKeyword.value.trim();\n  params.page = 1;\n\n  if (!params.q) {\n    return iziToast.error({\n      message: 'The field in which you enter the text cannot be empty',\n      position: 'center',\n      backgroundColor: 'rgba(239, 64, 64, 1)',\n      messageColor: 'rgba(250, 250, 251, 1)',\n      // iconUrl: './img/octagon.svg', don`t work after deploy\n      messageSize: '16',\n      messageLineHeight: '24',\n    });\n  }\n  loaderEl.classList.remove('is-hidden');\n\n  try {\n    const imagesData = await fetchPhotos(params);\n    params.maxPage = Math.ceil(imagesData.totalHits / params.pageSize);\n    if (imagesData.hits.length === 0) {\n      return iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'center',\n        backgroundColor: 'rgba(239, 64, 64, 1)',\n        messageColor: 'rgba(250, 250, 251, 1)',\n        // iconUrl: './img/octagon.svg', don`t work after deploy\n        messageSize: '16',\n        messageLineHeight: '24',\n      });\n    }\n\n    galleryEl.insertAdjacentHTML('beforeend', createMarkup(imagesData.hits));\n\n    lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n    lightbox.refresh();\n  } catch (err) {\n    console.log(err);\n  } finally {\n    loaderEl.classList.add('is-hidden');\n    event.target.reset();\n  }\n\n  loadMoreEl.classList.remove('is-hidden');\n  loadMoreEl.addEventListener('click', onLoadMore);\n}\n\nasync function onLoadMore() {\n  params.page += 1;\n  try {\n    const imagesData = await fetchPhotos(params);\n\n    galleryEl.insertAdjacentHTML('beforeend', createMarkup(imagesData.hits));\n    const cardHeight = galleryEl\n      .querySelector('.card-container')\n      .getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: 2 * cardHeight,\n      behavior: 'smooth',\n    });\n\n    lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n    lightbox.refresh();\n  } catch (err) {\n    throw new Error('Sorry, something went wrong with the API request.');\n  } finally {\n    if (params.page === params.maxPage) {\n      loadMoreEl.classList.add('is-hidden');\n      loadMoreEl.removeEventListener('click', onLoadMore);\n      iziToast.error({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'center',\n        backgroundColor: 'rgba(239, 64, 64, 1)',\n        messageColor: 'rgba(250, 250, 251, 1)',\n        // iconUrl: './img/octagon.svg', don`t work after deploy\n        messageSize: '16',\n        messageLineHeight: '24',\n      });\n    }\n  }\n}\n"],"names":["BASE_URL","ENDPOINT","API_KEY","axios","fetchPhotos","q","page","pageSize","createMarkup","images","tags","webformatURL","largeImageURL","likes","views","comments","downloads","galleryEl","searchFormEl","loaderEl","loadMoreEl","refs","params","lightbox","onSearch","event","iziToast","imagesData","SimpleLightbox","err","onLoadMore","cardHeight"],"mappings":"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"}